<div class="paper-card" style="padding: 1.5em; margin-top: 0;">
    <h2 style="margin-top:0;">Process TV Shows</h2>
    <div class="fieldDescription" style="margin-bottom: 1em;">Manually trigger credits detection for specific TV shows or all shows in your library.</div>

    <div class="selectContainer">
        <label class="selectLabel" for="selectLibraryFilter">Filter by Library (Optional)</label>
        <select is="emby-select" id="selectLibraryFilter">
            <option value="">-- All Libraries --</option>
        </select>
        <div class="fieldDescription">Filter TV shows by library</div>
    </div>

    <div class="selectContainer">
        <label class="selectLabel" for="selectSeries">Select a TV Show</label>
        <select is="emby-select" id="selectSeries" data-config-key="SelectedSeries">
            <option value="">-- All TV Shows --</option>
        </select>
        <div class="fieldDescription">Choose a specific TV show to process, or leave empty to process all shows</div>
    </div>

    <div class="selectContainer">
        <label class="selectLabel" for="selectEpisode">Select a Single Episode (Optional)</label>
        <select is="emby-select" id="selectEpisode" data-config-key="SelectedEpisode">
            <option value="">-- Select Show First --</option>
        </select>
        <div class="fieldDescription">Choose a specific episode to process, or leave empty to process all episodes in the selected show</div>
    </div>

    <div style="margin-top: 1.5em;">
        <button is="emby-button" type="button" class="raised button-submit" id="btnProcessSeries">
            <span>Process Selection</span>
        </button>
        <button is="emby-button" type="button" class="raised" id="btnDryRun" style="margin-left: 1em; background-color: #1e88e5;">
            <span>Dry Run</span>
        </button>
        <button is="emby-button" type="button" class="raised" id="btnDryRunDebug" style="margin-left: 1em; background-color: #9c27b0;">
            <i class="md-icon">bug_report</i>
            <span>Dry Run with Debug</span>
        </button>
        <button is="emby-button" type="button" class="raised" id="btnQueueAllSeries" style="margin-left: 1em;">
            <span>Queue All Shows</span>
        </button>
        <button is="emby-button" type="button" class="raised button-cancel" id="btnClearQueue" style="margin-left: 1em; background-color: #E53935;">
            <i class="md-icon">clear_all</i>
            <span>Clear Queue</span>
        </button>
    </div>
    <div style="margin-top: 0.5em; padding: 0.5em; background-color: rgba(245,245,245,0.95); border-radius: 4px; border-left: 3px solid #1e88e5;">
        <span style="font-size: 0.9em; color: #333 !important;"><strong style="color: #1e88e5;">Dry Run:</strong> Detects credits without saving chapter markers - useful for testing detection accuracy.</span><br>
        <span style="font-size: 0.9em; color: #333 !important;"><strong style="color: #9c27b0;">Dry Run with Debug:</strong> Same as Dry Run but captures detailed debug logs and downloads them for troubleshooting.</span>
    </div>

    <div id="progressContainer" style="margin-top: 2em; display: none;">
        <div class="fieldDescription" style="margin-bottom: 0.5em;">
            <strong>Processing: <span id="currentItem">-</span></strong>
        </div>
        <div style="background: rgba(255,255,255,0.1); border-radius: 4px; height: 24px; overflow: hidden; position: relative; margin-bottom: 0.5em;">
            <div id="progressBar" style="background: linear-gradient(90deg, #52B54B 0%, #6FC774 100%); height: 100%; width: 0%; transition: width 0.3s ease; display: flex; align-items: center; justify-content: center;">
                <span id="percentText" style="color: white; font-weight: bold; font-size: 0.9em; text-shadow: 0 1px 2px rgba(0,0,0,0.5);"></span>
            </div>
        </div>
        <div style="background: rgba(255,255,255,0.05); border-radius: 4px; height: 8px; overflow: hidden; position: relative; margin-bottom: 0.5em;">
            <div id="itemProgressBar" style="background: linear-gradient(90deg, #4A9FE5 0%, #5AAEF5 100%); height: 100%; width: 0%; transition: width 0.3s ease;"></div>
        </div>
        <div style="display: flex; justify-content: space-between; font-size: 0.9em; color: rgba(255,255,255,0.7); margin-bottom: 0.5em;">
            <span>Episodes: <span id="progressCount">0/0</span></span>
            <span>Success: <span id="successCount">0</span> | Failed: <span id="failedCount">0</span></span>
            <span>ETA: <span id="etaText">-</span></span>
        </div>
        <div style="text-align: center;">
            <button is="emby-button" type="button" class="raised button-cancel" id="btnCancelProcessing" style="background-color: #E53935; color: white;">
                <i class="md-icon">cancel</i>
                <span>Cancel Processing</span>
            </button>
        </div>
    </div>

    <div id="failureDetails" style="margin-top: 1.5em; display: none;">
        <h3 style="color: #E5A54A; margin-bottom: 0.5em;">Failed Episodes</h3>
        <div id="failureList" style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 1em; max-height: 300px; overflow-y: auto;"></div>
    </div>
    <div id="successDetails" style="margin-top: 1.5em; display: none;">
        <h3 style="color: #52b54b; margin-bottom: 0.5em;">Successfully Detected Markers</h3>
        <div id="successList" style="background: rgba(255,255,255,0.05); border-radius: 4px; padding: 1em; max-height: 300px; overflow-y: auto;"></div>
    </div>
</div>

<div class="paper-card" style="padding: 1.5em; margin-top: 2em;">
    <h2 style="margin-top:0;">View Chapter Markers</h2>
    <div class="fieldDescription" style="margin-bottom: 1em;">View existing chapter markers for episodes in a TV show to verify detection results.</div>

    <div class="selectContainer">
        <label class="selectLabel" for="selectSeriesForMarkers">Select a TV Show</label>
        <select is="emby-select" id="selectSeriesForMarkers">
            <option value="">-- Select a TV Show --</option>
        </select>
        <div class="fieldDescription">Choose a TV show to view its episode markers</div>
    </div>

    <div id="markersDisplay" style="margin-top: 2em; display: none;">
        <h3 id="markersSeriesName" style="color: #52B54B;"></h3>
        <div id="markersContent" style="max-height: 500px; overflow-y: auto;"></div>
    </div>
</div>

<div class="paper-card" style="padding: 1.5em; margin-top: 2em; border-left: 4px solid #4A9FE5;">
    <h2 style="margin-top:0; color: #4A9FE5;">ðŸ’¾ Backup & Restore Credits Markers</h2>
    <div class="fieldDescription" style="margin-bottom: 1.5em;">Export and import credits markers with TheTVDB IDs for portability between Emby servers. Perfect for backups, server migrations, or sharing detection results.</div>

    <div style="display: flex; gap: 1em; flex-wrap: wrap; margin-bottom: 1.5em;">
        <button is="emby-button" type="button" class="raised button-submit" id="btnExportBackup" style="flex: 1; min-width: 200px;">
            <i class="md-icon">download</i>
            <span>Export Credits Backup</span>
        </button>
        <button is="emby-button" type="button" class="raised" id="btnImportBackup" style="flex: 1; min-width: 200px;">
            <i class="md-icon">upload</i>
            <span>Import Credits Backup</span>
        </button>
    </div>

    <div class="fieldDescription" style="font-size: 0.9em; opacity: 0.8;">
        <strong>Export:</strong> Downloads a JSON file with all detected credits markers, including TheTVDB IDs for portable matching.<br>
        <strong>Import:</strong> Restores credits markers from a backup file. Matches episodes by TheTVDB ID, internal ID, file path, or series + season/episode number.
    </div>

    <div class="checkboxContainer" style="margin-top: 1.5em;">
        <label>
            <input is="emby-checkbox" type="checkbox" id="chkBackupImportOverwriteExisting" data-config-key="BackupImportOverwriteExisting" />
            <span>Overwrite Existing Credits on Import</span>
        </label>
        <div class="fieldDescription">When enabled, importing a backup will overwrite existing credits markers. When disabled, episodes with existing markers will be skipped.</div>
    </div>
</div>

<div class="paper-card" style="padding: 1.5em; margin-top: 2em; text-align: center; background: linear-gradient(135deg, rgba(255,221,87,0.1) 0%, rgba(255,152,0,0.1) 100%); border-left: 4px solid #FFA726;">
    <h3 style="margin-top: 0; color: #F57C00;">â˜• Support This Plugin</h3>
    <a href="https://buymeacoffee.com/yockser" target="_blank" rel="noopener noreferrer">
        <img id="donateImage" alt="Buy Me A Coffee" style="max-width: 200px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); transition: transform 0.2s;" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
    </a>
    <p style="margin-top: 0.75em; font-size: 0.95em; opacity: 0.85;">If you like this plugin please consider donating a coffee.</p>
    <p style="margin-top: 1em; font-size: 0.9em; color: #52B54B; font-style: italic;">Special thanks to Neminem for the help with this plugin</p>
</div>
